syntax = "proto3";

message Player {
  optional string id = 1;
  optional string name = 2;
  optional string icon = 3;
  optional string color = 4;
  optional int32 score = 5;
}

message Task {
  string text = 1;
  /* string icon = 2; */
  repeated string tags = 3;
  repeated string colors = 4;
}

message Event {
  int32 timestamp = 1;
  string message = 2;
}

message Options {
  string setupChecksum = 1;
  int32 seed = 2;
  repeated string includedTags = 3;
  repeated string excludedTags = 4;
  boolean isLockout = 5;
  int32 timeLimitMinutes = 6;
  int32 taskCount = 7;
}

message GameState {
  boolean isActive = 1;
  repeated Player players = 2;
  repeated Task tasks = 3;
  repeated Event events = 4;
  optional Options options = 5;
}

message MessageEnvelope {
  /* 
   * One of following:
   *  receiveId         - Server -> Client : assigns client their unique ID
   *  gameStateUpdate   - Server -> Client : update to the game state
   *  profileUpdate     - Client -> Server : update own profile
   *  taskUpdate        - Client -> Server : update task completion for self
   *  requestStart      - Client -> Server : request game to (re)start
   */
  string type = 1;

  oneof payload {
    string id = 2;
    GameState gameState = 3;
    Player player = 4;
  }
}